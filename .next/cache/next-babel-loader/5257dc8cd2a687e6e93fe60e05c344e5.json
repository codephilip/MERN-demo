{"ast":null,"code":"import Budget from \"../../models/Budget\";\nimport connectDb from \"../../utils/connectDb\";\nconnectDb();\nexport default (async (req, res) => {\n  switch (req.method) {\n    case \"GET\":\n      await handleGetRequest(req, res);\n      break;\n\n    case \"POST\":\n      await handlePostRequest(req, res);\n      break;\n\n    case \"DELETE\":\n      await handleDeleteRequest(req, res);\n      break;\n\n    default:\n      res.status(405).send(`Method ${req.method} not allowed`);\n      break;\n  }\n});\n\nasync function handleGetRequest(req, res) {\n  const {\n    user\n  } = req.query;\n  const budget = await Budget.findOne({\n    user\n  });\n  res.status(200).json(budget);\n}\n\nasync function handlePostRequest(req, res) {\n  const {\n    type,\n    name,\n    ammount\n  } = req.body;\n\n  try {\n    if (!type || !name || !ammount) {\n      return res.status(422).send(\"Product missing one or more fields\");\n    }\n\n    const budget = await new Budget({\n      type,\n      name,\n      ammount\n    }).save();\n    res.status(201).json(budget);\n  } catch (error) {\n    console.error(error);\n    res.status(500).send(\"Server error in creating product\");\n  }\n}\n\nasync function handleDeleteRequest(req, res) {\n  const {\n    user\n  } = req.query;\n  await Budget.findOneAndDelete({\n    user\n  });\n  res.status(204).json({});\n}","map":{"version":3,"sources":["C:\\Users\\phili\\Documents\\Coding\\MERN\\11.20.20MERN\\MERN\\pages\\api\\budget.js"],"names":["Budget","connectDb","req","res","method","handleGetRequest","handlePostRequest","handleDeleteRequest","status","send","user","query","budget","findOne","json","type","name","ammount","body","save","error","console","findOneAndDelete"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,qBAAnB;AACA,OAAOC,SAAP,MAAsB,uBAAtB;AAEAA,SAAS;AAET,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjC,UAAQD,GAAG,CAACE,MAAZ;AACE,SAAK,KAAL;AACE,YAAMC,gBAAgB,CAACH,GAAD,EAAMC,GAAN,CAAtB;AACA;;AACF,SAAK,MAAL;AACE,YAAMG,iBAAiB,CAACJ,GAAD,EAAMC,GAAN,CAAvB;AACA;;AACF,SAAK,QAAL;AACE,YAAMI,mBAAmB,CAACL,GAAD,EAAMC,GAAN,CAAzB;AACA;;AACF;AACEA,MAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAsB,UAASP,GAAG,CAACE,MAAO,cAA1C;AACA;AAZJ;AAcD,CAfD;;AAiBA,eAAeC,gBAAf,CAAgCH,GAAhC,EAAqCC,GAArC,EAA0C;AACxC,QAAM;AAAEO,IAAAA;AAAF,MAAWR,GAAG,CAACS,KAArB;AACA,QAAMC,MAAM,GAAG,MAAMZ,MAAM,CAACa,OAAP,CAAe;AAAEH,IAAAA;AAAF,GAAf,CAArB;AACAP,EAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqBF,MAArB;AACD;;AAED,eAAeN,iBAAf,CAAiCJ,GAAjC,EAAsCC,GAAtC,EAA2C;AACzC,QAAM;AAAEY,IAAAA,IAAF;AAAQC,IAAAA,IAAR;AAAcC,IAAAA;AAAd,MAA0Bf,GAAG,CAACgB,IAApC;;AACA,MAAI;AACF,QAAI,CAACH,IAAD,IAAS,CAACC,IAAV,IAAkB,CAACC,OAAvB,EAAgC;AAC9B,aAAOd,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,oCAArB,CAAP;AACD;;AACD,UAAMG,MAAM,GAAG,MAAM,IAAIZ,MAAJ,CAAW;AAC5Be,MAAAA,IAD4B;AAE5BC,MAAAA,IAF4B;AAG5BC,MAAAA;AAH4B,KAAX,EAIlBE,IAJkB,EAArB;AAKAhB,IAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqBF,MAArB;AACD,GAVD,CAUE,OAAOQ,KAAP,EAAc;AACdC,IAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACAjB,IAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,kCAArB;AACD;AACF;;AAED,eAAeF,mBAAf,CAAmCL,GAAnC,EAAwCC,GAAxC,EAA6C;AAC3C,QAAM;AAAEO,IAAAA;AAAF,MAAWR,GAAG,CAACS,KAArB;AACA,QAAMX,MAAM,CAACsB,gBAAP,CAAwB;AAAEZ,IAAAA;AAAF,GAAxB,CAAN;AACAP,EAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAArB;AACD","sourcesContent":["import Budget from \"../../models/Budget\";\r\nimport connectDb from \"../../utils/connectDb\";\r\n\r\nconnectDb();\r\n\r\nexport default async (req, res) => {\r\n  switch (req.method) {\r\n    case \"GET\":\r\n      await handleGetRequest(req, res);\r\n      break;\r\n    case \"POST\":\r\n      await handlePostRequest(req, res);\r\n      break;\r\n    case \"DELETE\":\r\n      await handleDeleteRequest(req, res);\r\n      break;\r\n    default:\r\n      res.status(405).send(`Method ${req.method} not allowed`);\r\n      break;\r\n  }\r\n};\r\n\r\nasync function handleGetRequest(req, res) {\r\n  const { user } = req.query;\r\n  const budget = await Budget.findOne({ user });\r\n  res.status(200).json(budget);\r\n}\r\n\r\nasync function handlePostRequest(req, res) {\r\n  const { type, name, ammount } = req.body;\r\n  try {\r\n    if (!type || !name || !ammount) {\r\n      return res.status(422).send(\"Product missing one or more fields\");\r\n    }\r\n    const budget = await new Budget({\r\n        type,\r\n        name,\r\n        ammount,\r\n    }).save();\r\n    res.status(201).json(budget);\r\n  } catch (error) {\r\n    console.error(error);\r\n    res.status(500).send(\"Server error in creating product\");\r\n  }\r\n}\r\n\r\nasync function handleDeleteRequest(req, res) {\r\n  const { user } = req.query;\r\n  await Budget.findOneAndDelete({ user });\r\n  res.status(204).json({});\r\n}\r\n"]},"metadata":{},"sourceType":"module"}